<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå¥½ä¼´ - æ™ºèƒ½AIå¯¹è¯ã€å†™ä½œä¸ç”»å›¾ç”Ÿæˆå·¥å…·</title>
    <meta name="description" content="AIå¥½ä¼´ï¼Œä½ çš„æ™ºèƒ½ä¼´ä¾£ï¼šæ”¯æŒè‡ªç„¶å¯¹è¯ã€åˆ›æ„å†™ä½œå’ŒAIç”»å›¾ç”Ÿæˆã€‚å…è´¹è¯•ç”¨ï¼Œé«˜æ•ˆå¯é ã€‚">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¤–</text></svg>">
    
    <!-- CSS Styles -->
    <style>
        /* å…¨å±€æ ·å¼ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; color: #333; transition: background 0.3s; }
        body.dark { background: #121212; color: #e0e0e0; }
        
        /* å¤´éƒ¨ */
        header { background: #007bff; color: white; padding: 1rem; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        header.dark { background: #1a1a2e; }
        .logo { font-size: 1.5rem; font-weight: bold; }
        .theme-toggle { background: none; border: 1px solid white; color: white; padding: 0.5rem; cursor: pointer; border-radius: 4px; }
        .theme-toggle.dark { border-color: #e0e0e0; color: #e0e0e0; }
        
        /* ä¾§è¾¹æ ï¼šæ¨¡å¼å’Œå·¥å…· */
        aside { position: fixed; left: 0; top: 70px; width: 250px; height: calc(100vh - 70px); background: white; border-right: 1px solid #ddd; padding: 1rem; overflow-y: auto; transition: transform 0.3s; z-index: 10; }
        aside.dark { background: #1e1e1e; border-color: #333; }
        aside.hidden { transform: translateX(-100%); }
        .mode-btn, .tool-btn { display: block; width: 100%; padding: 0.75rem; margin: 0.5rem 0; border: 1px solid #ddd; background: none; cursor: pointer; border-radius: 4px; text-align: left; }
        .mode-btn.active, .tool-btn:hover { background: #007bff; color: white; }
        .mode-btn.active.dark, .tool-btn:hover.dark { background: #0056b3; }
        aside.dark .mode-btn, aside.dark .tool-btn { border-color: #444; }
        
        /* ä¸»å†…å®¹ï¼šèŠå¤©åŒºåŸŸ */
        main { margin-left: 250px; margin-top: 70px; padding: 2rem; height: calc(100vh - 70px); display: flex; flex-direction: column; }
        .chat-container { flex: 1; overflow-y: auto; padding: 1rem 0; }
        .message { margin: 1rem 0; padding: 1rem; border-radius: 8px; max-width: 80%; }
        .message.user { background: #007bff; color: white; margin-left: auto; }
        .message.ai { background: #e9ecef; color: #333; }
        .message.ai.dark { background: #2a2a2a; color: #e0e0e0; }
        .message img { max-width: 100%; border-radius: 4px; margin-top: 0.5rem; }
        
        /* è¾“å…¥åŒºåŸŸ */
        .input-area { display: flex; padding: 1rem; background: white; border-top: 1px solid #ddd; }
        .input-area.dark { background: #1e1e1e; border-color: #333; }
        #messageInput { flex: 1; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px 0 0 4px; }
        #messageInput.dark { background: #2a2a2a; border-color: #444; color: #e0e0e0; }
        #sendBtn { padding: 0.75rem 1.5rem; background: #007bff; color: white; border: none; cursor: pointer; border-radius: 0 4px 4px 0; }
        #sendBtn:hover { background: #0056b3; }
        #sendBtn.dark { background: #1a1a2e; }
        
        /* å“åº”å¼ï¼šç§»åŠ¨ç«¯éšè—ä¾§è¾¹æ  */
        @media (max-width: 768px) { aside { transform: translateX(-100%); } main { margin-left: 0; } .toggle-sidebar { position: fixed; top: 1rem; left: 1rem; z-index: 11; background: #007bff; color: white; border: none; padding: 0.5rem; cursor: pointer; } }
        
        /* Markdown æ¸²æŸ“ */
        .markdown { line-height: 1.6; }
        .markdown h1, .markdown h2 { margin: 1rem 0 0.5rem; }
        .markdown code { background: #f8f9fa; padding: 0.2rem 0.4rem; border-radius: 3px; font-family: monospace; }
        .markdown pre { background: #f8f9fa; padding: 1rem; overflow-x: auto; border-radius: 4px; }
        .markdown pre.dark { background: #2a2a2a; }
    </style>
    
    <!-- å¤–éƒ¨åº“ï¼šMarked.js for Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <header>
        <div class="logo">ğŸ¤– AIå¥½ä¼´</div>
        <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™ æš—æ¨¡å¼</button>
    </header>
    
    <button class="toggle-sidebar" onclick="toggleSidebar()" style="display: none;">â˜°</button>
    
    <aside id="sidebar">
        <h3>æ¨¡å¼åˆ‡æ¢</h3>
        <button class="mode-btn active" data-mode="chat" onclick="switchMode('chat')">ğŸ’¬ æ™ºèƒ½å¯¹è¯</button>
        <button class="mode-btn" data-mode="write" onclick="switchMode('write')">âœï¸ åˆ›æ„å†™ä½œ</button>
        <button class="mode-btn" data-mode="draw" onclick="switchMode('draw')">ğŸ¨ AIç”»å›¾</button>
        
        <h3 style="margin-top: 2rem;">å·¥å…·ç®±</h3>
        <button class="tool-btn" onclick="useTool('search')">ğŸ” ç½‘é¡µæœç´¢</button>
        <button class="tool-btn" onclick="useTool('code')">ğŸ’» ä»£ç æ‰§è¡Œ</button>
        <button class="tool-btn" onclick="useTool('weather')">ğŸŒ¤ï¸ å¤©æ°”æŸ¥è¯¢</button>
        <button class="tool-btn" onclick="useTool('image')">ğŸ–¼ï¸ ç”Ÿæˆå›¾åƒ</button>
    </aside>
    
    <main>
        <div class="chat-container" id="chatContainer">
            <div class="message ai">
                <p>æ¬¢è¿ä½¿ç”¨AIå¥½ä¼´ï¼æˆ‘æ˜¯ä½ çš„æ™ºèƒ½ä¼´ä¾£ï¼Œæ”¯æŒå¯¹è¯ã€å†™ä½œå’Œç”»å›¾ã€‚è¯•è¯•åˆ‡æ¢æ¨¡å¼æˆ–ä½¿ç”¨å·¥å…·å§~</p>
            </div>
        </div>
        
        <div class="input-area">
            <input type="text" id="messageInput" placeholder="è¾“å…¥ä½ çš„æ¶ˆæ¯... (Ctrl+Enter å‘é€)" onkeypress="handleKeyPress(event)">
            <button id="sendBtn" onclick="sendMessage()">å‘é€</button>
        </div>
    </main>
    
    <script>
        // å…¨å±€å˜é‡
        let currentMode = 'chat'; // å½“å‰æ¨¡å¼ï¼šchat, write, draw
        let messages = JSON.parse(localStorage.getItem('aihaoban_messages')) || []; // æ¶ˆæ¯å†å²
        const API_BASE = 'https://api.aihaoban.cn'; // æ›¿æ¢ä¸ºæ‚¨çš„APIç«¯ç‚¹ï¼ˆæ¨¡æ‹Ÿå ä½ï¼‰
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadMessages();
            updatePlaceholder();
            if (window.innerWidth <= 768) document.querySelector('.toggle-sidebar').style.display = 'block';
        });
        
        // ä¸»é¢˜åˆ‡æ¢
        function toggleTheme() {
            document.body.classList.toggle('dark');
            const btn = document.querySelector('.theme-toggle');
            btn.textContent = document.body.classList.contains('dark') ? 'â˜€ï¸ äº®æ¨¡å¼' : 'ğŸŒ™ æš—æ¨¡å¼';
            localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
        }
        if (localStorage.getItem('theme') === 'dark') toggleTheme();
        
        // ä¾§è¾¹æ åˆ‡æ¢ï¼ˆç§»åŠ¨ç«¯ï¼‰
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('hidden');
        }
        
        // æ¨¡å¼åˆ‡æ¢
        function switchMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            updatePlaceholder();
            // æ¸…ç©ºèŠå¤©ï¼ˆå¯é€‰ï¼‰
            if (confirm('åˆ‡æ¢æ¨¡å¼å°†æ¸…ç©ºå½“å‰èŠå¤©ï¼Œç¡®è®¤å—ï¼Ÿ')) {
                messages = [];
                saveMessages();
                document.getElementById('chatContainer').innerHTML = `<div class="message ai"><p>å·²åˆ‡æ¢åˆ°${getModeName(mode)}æ¨¡å¼ã€‚å¼€å§‹æ–°å¯¹è¯å§ï¼</p></div>`;
            }
        }
        function getModeName(mode) {
            const names = { chat: 'æ™ºèƒ½å¯¹è¯', write: 'åˆ›æ„å†™ä½œ', draw: 'AIç”»å›¾' };
            return names[mode] || 'æœªçŸ¥';
        }
        function updatePlaceholder() {
            const input = document.getElementById('messageInput');
            const placeholders = {
                chat: 'èŠèŠä»Šå¤©çš„å¿ƒæƒ…ï¼Ÿ',
                write: 'æè¿°ä½ çš„å†™ä½œä¸»é¢˜...',
                draw: 'è¾“å…¥ç”»å›¾æç¤ºï¼Œå¦‚â€œä¸€åªé£ç¿”çš„é¾™â€'
            };
            input.placeholder = placeholders[currentMode] || 'è¾“å…¥ä½ çš„æ¶ˆæ¯...';
        }
        
        // å‘é€æ¶ˆæ¯
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            if (!text) return;
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            addMessage(text, 'user');
            input.value = '';
            
            // æ¨¡æ‹ŸAIå“åº”ï¼ˆæ›¿æ¢ä¸ºå®é™…APIè°ƒç”¨ï¼‰
            setTimeout(() => {
                let response = generateResponse(text, currentMode);
                if (currentMode === 'draw') {
                    response = `<p>ç”Ÿæˆå›¾åƒä¸­... æç¤ºï¼š${text}</p><img src="https://via.placeholder.com/400x300/007bff/white?text=AI+Generated+Image: ${encodeURIComponent(text)}" alt="AIå›¾åƒ">`;
                }
                addMessage(response, 'ai');
            }, 1000);
        }
        
        // é”®ç›˜äº‹ä»¶
        function handleKeyPress(event) {
            if (event.key === 'Enter' && (event.ctrlKey || event.metaKey)) sendMessage();
        }
        
        // æ·»åŠ æ¶ˆæ¯
        function addMessage(text, sender) {
            const msg = { text, sender, timestamp: new Date().toISOString() };
            messages.push(msg);
            saveMessages();
            renderMessage(msg);
        }
        
        // æ¸²æŸ“æ¶ˆæ¯ï¼ˆæ”¯æŒMarkdownï¼‰
        function renderMessage(msg) {
            const container = document.getElementById('chatContainer');
            const div = document.createElement('div');
            div.className = `message ${msg.sender}`;
            if (msg.sender === 'ai') {
                div.innerHTML = `<div class="markdown">${marked.parse(msg.text)}</div>`;
            } else {
                div.textContent = msg.text;
            }
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }
        
        // ç”Ÿæˆå“åº”ï¼ˆæ¨¡æ‹Ÿï¼Œæ ¹æ®æ¨¡å¼ï¼‰
        function generateResponse(text, mode) {
            const responses = {
                chat: `åœ¨${mode}æ¨¡å¼ä¸‹ï¼Œä½ è¯´ï¼š${text}ã€‚æˆ‘ç†è§£ä½ çš„æ„æ€ï¼Œè®©æˆ‘ä»¬æ·±å…¥èŠèŠï¼ï¼ˆæ¨¡æ‹Ÿå“åº”ï¼Œå¯æ›¿æ¢APIï¼‰`,
                write: `å†™ä½œçµæ„Ÿï¼šåŸºäºâ€œ${text}â€ï¼Œæˆ‘ä¸ºä½ ç”Ÿæˆä¸€æ®µæ•…äº‹å¼€å¤´ï¼šä»å‰ï¼Œæœ‰ä¸€ä¸ª...ï¼ˆç»§ç»­æ‰©å±•ï¼‰`,
                draw: '' // ç”±sendMessageå¤„ç†å›¾åƒ
            };
            // å®é™…ä¸­è°ƒç”¨API: fetch(`${API_BASE}/generate?mode=${mode}&prompt=${encodeURIComponent(text)}`)
            return responses[mode] || 'æœ‰è¶£çš„æƒ³æ³•ï¼AIå¥½ä¼´åœ¨æ€è€ƒä¸­...';
        }
        
        // å·¥å…·ä½¿ç”¨
        function useTool(tool) {
            let prompt = '';
            switch (tool) {
                case 'search':
                    prompt = prompt('è¾“å…¥æœç´¢å…³é”®è¯ï¼š');
                    addMessage(`ä½¿ç”¨å·¥å…·ï¼šç½‘é¡µæœç´¢ "${prompt}"`, 'user');
                    setTimeout(() => addMessage(`æœç´¢ç»“æœï¼šæ‰¾åˆ°äº†ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬AIå·¥å…·æ•™ç¨‹ã€‚ï¼ˆæ¨¡æ‹Ÿï¼Œå®é™…è°ƒç”¨web_search APIï¼‰`, 'ai'), 1500);
                    break;
                case 'code':
                    prompt = prompt('è¾“å…¥ä»£ç ç‰‡æ®µï¼š');
                    addMessage(`æ‰§è¡Œä»£ç ï¼š${prompt}`, 'user');
                    // æ¨¡æ‹Ÿä»£ç æ‰§è¡Œ
                    setTimeout(() => addMessage(`ä»£ç è¾“å‡ºï¼šç»“æœä¸º42ã€‚ï¼ˆä½¿ç”¨code_executionå·¥å…·æ¨¡æ‹Ÿï¼‰`, 'ai'), 1500);
                    break;
                case 'weather':
                    prompt = prompt('è¾“å…¥åŸå¸‚ï¼š');
                    addMessage(`æŸ¥è¯¢å¤©æ°”ï¼š${prompt}`, 'user');
                    setTimeout(() => addMessage(`åŒ—äº¬å¤©æ°”ï¼šæ™´ï¼Œ25Â°Cã€‚ï¼ˆè°ƒç”¨weather APIï¼‰`, 'ai'), 1500);
                    break;
                case 'image':
                    prompt = prompt('è¾“å…¥å›¾åƒæè¿°ï¼š');
                    addMessage(`ç”Ÿæˆå›¾åƒï¼š${prompt}`, 'user');
                    setTimeout(() => {
                        const imgSrc = `https://via.placeholder.com/400x300/28a745/white?text=AI+Image: ${encodeURIComponent(prompt)}`;
                        addMessage(`<p>å›¾åƒç”Ÿæˆå®Œæˆï¼</p><img src="${imgSrc}" alt="ç”Ÿæˆå›¾åƒ">`, 'ai');
                    }, 2000);
                    break;
            }
            function prompt(msg) { return prompt(msg); } // ç®€å•promptï¼Œå®é™…ç”¨modal
        }
        
        // åŠ è½½/ä¿å­˜æ¶ˆæ¯
        function loadMessages() {
            messages.forEach(renderMessage);
        }
        function saveMessages() {
            localStorage.setItem('aihaoban_messages', JSON.stringify(messages.slice(-50))); // é™50æ¡
        }
        
        // æ¸…ç©ºèŠå¤©
        window.clearChat = () => { if (confirm('æ¸…ç©ºèŠå¤©å†å²ï¼Ÿ')) { messages = []; saveMessages(); document.getElementById('chatContainer').innerHTML = ''; } };
    </script>
</body>
</html>
